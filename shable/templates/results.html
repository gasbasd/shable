<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">

<xi:include href="master.html"/>

<head>
    <title>Mainpage home</title>
    <style>
        .bm-color {
            color: #003399;
        }

        html, body, #map_canvas {
            height: 400px;
            width: 100%;
            margin-top: 30px;
        }

    </style>
</head>
<body>
<div class="row">
    ${form.display(value=value)}
</div>

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

<!-- CHECK ELEMENT ID also UPDATE CSS -->
<div id="map_canvas"></div>

<script>
    var points = ${geo_points_json};
    var description = ${geo_points_description};

    // <![CDATA[
    var map;

    function initialize() {
        var mapOptions = { center: new google.maps.LatLng(points[0][1], points[0][0]),
            zoom: 14,
            mapTypeId: google.maps.MapTypeId.ROADMAP };
        map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

        var markers = [];

        var infowindow = new google.maps.InfoWindow();

        for (var i = 1; i < points.length; i++) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(points[i][1], points[i][0]),
                map: map
            });

            makeInfoWindowEvent(map, infowindow, description[i], marker);

            markers.push(marker);
        }

    }

    function makeInfoWindowEvent(map, infowindow, contentString, marker) {
        google.maps.event.addListener(marker, 'click', function () {
            infowindow.setContent(contentString);
            infowindow.open(map, marker);
        });
    }
    google.maps.event.addDomListener(window, 'load', initialize);
    // ]]>
</script>
</body>
</html>